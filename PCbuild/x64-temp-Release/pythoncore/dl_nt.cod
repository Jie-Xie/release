; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

include listing.inc

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	dllVersionBuffer
PUBLIC	PyWin_DLLhModule
PUBLIC	PyWin_DLLVersionString
_BSS	SEGMENT
dllVersionBuffer DB 010H DUP (?)
PyWin_DLLhModule DQ 01H DUP (?)
_BSS	ENDS
_DATA	SEGMENT
PyWin_DLLVersionString DQ FLAT:dllVersionBuffer
_DATA	ENDS
PUBLIC	DllMain
EXTRN	__imp_LoadStringA:PROC
;	COMDAT pdata
; File c:\src\pyparallel\pc\dl_nt.c
pdata	SEGMENT
$pdata$DllMain DD imagerel $LN8
	DD	imagerel $LN8+47
	DD	imagerel $unwind$DllMain
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$DllMain DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT DllMain
_TEXT	SEGMENT
hInst$ = 48
ul_reason_for_call$ = 56
lpReserved$ = 64
DllMain	PROC						; COMDAT

; 86   : {

$LN8:
  00000	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 87   :     switch (ul_reason_for_call)

  00004	ff ca		 dec	 edx
  00006	75 1d		 jne	 SHORT $LN7@DllMain

; 88   :     {
; 89   :         case DLL_PROCESS_ATTACH:
; 90   :             PyWin_DLLhModule = hInst;
; 91   :             // 1000 is a magic number I picked out of the air.  Could do with a #define, I spose...
; 92   :             LoadString(hInst, 1000, dllVersionBuffer, sizeof(dllVersionBuffer));

  00008	44 8d 4a 10	 lea	 r9d, QWORD PTR [rdx+16]
  0000c	4c 8d 05 00 00
	00 00		 lea	 r8, OFFSET FLAT:dllVersionBuffer
  00013	ba e8 03 00 00	 mov	 edx, 1000		; 000003e8H
  00018	48 89 0d 00 00
	00 00		 mov	 QWORD PTR PyWin_DLLhModule, rcx
  0001f	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_LoadStringA
$LN7@DllMain:

; 93   : 
; 94   : #if HAVE_SXS
; 95   :             // and capture our activation context for use when loading extensions.
; 96   :             _LoadActCtxPointers();
; 97   :             if (pfnGetCurrentActCtx && pfnAddRefActCtx)
; 98   :                 if ((*pfnGetCurrentActCtx)(&PyWin_DLLhActivationContext))
; 99   :                     if (!(*pfnAddRefActCtx)(PyWin_DLLhActivationContext))
; 100  :                         OutputDebugString("Python failed to load the default activation context\n");
; 101  : #endif
; 102  :             break;
; 103  : 
; 104  :         case DLL_PROCESS_DETACH:
; 105  : #if HAVE_SXS
; 106  :             if (pfnReleaseActCtx)
; 107  :                 (*pfnReleaseActCtx)(PyWin_DLLhActivationContext);
; 108  : #endif
; 109  :             break;
; 110  :     }
; 111  :     return TRUE;

  00025	b8 01 00 00 00	 mov	 eax, 1

; 112  : }

  0002a	48 83 c4 28	 add	 rsp, 40			; 00000028H
  0002e	c3		 ret	 0
DllMain	ENDP
_TEXT	ENDS
END
